## 设计文档说明

1. 项目目标是通过大模型生成内容营销素材相关的内容，素材包含图片，文字，视频，音频等。本项目先生成图文，文字可为富文本，生成的内容经过人工校准修改后，可自动发布到各个媒体渠道。
2. 文档导航
   - **项目管理类**
     - [项目目标与范围](01. 项目管理类/01. 项目目标与范围.md)
   - **基础架构类**
     - [技术栈选型](02. 基础架构类/01. 技术栈选型.md)
     - [系统模块设计](02. 基础架构类/02. 系统模块设计.md)
     - [数据库设计](02. 基础架构类/03. 数据库设计.md)
     - [接口设计规范](02. 基础架构类/04. 接口设计规范.md)
     - [扩展性设计](02. 基础架构类/05. 扩展性设计.md)
   - **业务流程类**
     - [项目流程](03. 业务流程类/01. 项目流程.md)
     - [数据流转流程](03. 业务流程类/02. 数据流转流程.md)
     - [内容生命周期管理](03. 业务流程类/03. 内容生命周期管理.md)
   - **开发运维类**
     - [部署与运维](04. 开发运维类/01. 部署与运维.md)
     - [容灾备份策略](04. 开发运维类/02. 容灾备份策略.md)
     - [监控与可观测性](04. 开发运维类/03. 监控与可观测性.md)
   - **性能安全类**
     - [安全策略](05. 性能安全类/01. 安全策略.md)
     - [性能优化策略](05. 性能安全类/02. 性能优化策略.md)
     - [异常处理机制](05. 性能安全类/03. 异常处理机制.md)
   - **质量保障类**
     - [测试策略](06. 质量保障类/01. 测试策略.md)

2. 项目主要技术栈：

   - 大模型：OpenAI GPT-3.5、OpenAI GPT-4、OpenAI DALL-E、OpenAI Whisper、OpenAI ChatGLM、OpenAI ChatGLM2、OpenAI ChatGLM3、OpenAI ChatGLM4、OpenAI ChatGLM5、OpenAI ChatGLM6、OpenAI ChatGLM7、OpenAI ChatGLM8、OpenAI ChatGLM9、OpenAI ChatGLM10
   - 前端：Vue 框架 + Antd 组件库
   - 后端：SpringBoot + Spring AI + MyBatis + MySQL
   - 前后端打包到一个 docker 里

3. 项目流程：

- 用户上传图片，文字，视频，音频等素材，并选择素材类型。
- 项目会根据用户上传的素材，生成对应的内容，并返回给用户。
- 用户可对生成的内容进行人工校准修改，并保存。
- 项目会根据用户保存的修改后的内容，生成对应的内容，并返回给用户。
- 用户可对生成的内容进行发布，并选择发布渠道。
- 项目会根据用户选择的发布渠道，将内容发布到对应的渠道。
- 项目会记录用户操作的记录，并保存到数据库。
- 项目会定时任务，将用户操作的记录保存到数据库。
- 前端项目首期可不做权限管理和登陆，优先实现主流程。

4. 项目结构：
   - frontend: 前端代码
   - backend: 后端代码
     后端代码使用洋葱 DDD 项目结构，对接大模型，当前大模型选择 Deepseek 模型，并保留对其他模型的扩展性
     - domain: 领域模型
     - application: 应用层
     - infrastructure: 基础设施层
     - presentation: 表示层
     - test: 测试
     - config: 配置文件

5. 架构概述
   - 整体结构采用前后端分离设计，统一打包为Docker容器
   - 技术栈选型：
     前端：Vue框架 + Antd组件库
     后端：SpringBoot + Spring AI + MyBatis + MySQL
     大模型：Deepseek(主模型)，预留多模型扩展接口
   - 系统模块划分：
     前端：
       - 素材上传模块：支持多类型文件上传与预览
       - 内容编辑模块：富文本编辑与预览功能
       - 发布管理模块：渠道选择与发布状态跟踪
     后端：
       - 大模型服务模块：模型调用与结果处理
       - 内容生成模块：图文内容组装与格式化
       - 素材管理模块：文件存储与元数据管理
       - 发布服务模块：多渠道API集成
   - 数据流转流程：
     1. 用户上传素材 → 前端验证 → 后端存储
     2. 素材元数据 → 大模型服务 → 生成内容初稿
     3. 编辑后内容 → 数据库持久化 → 发布队列
     4. 发布任务 → 渠道API → 结果反馈
   - 接口设计规范：
     - RESTful API风格，版本控制(/api/v1/)
     - 统一响应格式：{code, message, data}
     - JWT身份验证(预留)
   - 扩展性设计：
     - 模型适配器模式：新增模型只需实现统一接口
     - 渠道策略模式：支持动态添加发布渠道
     - 配置中心：环境变量与配置文件分离
   - 异常处理机制：
     - 大模型调用失败：指数退避重试策略
     - 素材处理异常：异步任务队列+状态回调
     - 发布失败：自动重试+人工干预入口
   - 数据库设计：
     - 核心表结构：
       - materials: 素材元数据(id, type, url, size, upload_time)
       - generated_contents: 生成内容(id, material_id, content, status, created_at)
       - publish_records: 发布记录(id, content_id, channel, status, publish_time)
     - 索引策略：联合索引(material_id, status)加速查询
   - 安全策略：
     - 素材文件：存储路径加密+访问权限控制
     - API接口：请求频率限制+参数校验
     - 数据传输：HTTPS加密+敏感信息脱敏
   - 部署架构：
     - 开发环境：本地Docker容器
     - 生产环境：K8s集群部署
     - 资源配置：根据模型负载动态扩缩容
   - 性能优化策略：
     - 大模型调用：请求缓存+批量处理减少API调用次数
     - 素材存储：采用对象存储服务(OSS)，实现CDN加速
     - 数据库：读写分离+查询优化，减轻主库压力
     - 成本控制：按内容复杂度动态选择模型规格，设置API调用频率阈值
   - 容灾备份策略：
     - 数据备份：每日全量+增量备份，跨区域数据复制
     - 故障恢复：关键服务多实例部署，自动故障转移
     - 应急响应：建立服务降级预案，保障核心功能可用
   - DevOps流程：
     - CI/CD：GitLab CI自动化构建测试，Docker镜像版本管理
     - 环境管理：开发/测试/生产三环境隔离，配置动态注入
     - 发布策略：蓝绿部署减少发布风险，灰度放量验证新功能
   - 内容生命周期：
     - 素材管理：自动过期清理机制，定期归档历史素材
     - 版本控制：生成内容修改记录追踪，支持回滚到历史版本
   - 监控与可观测性：
     - 系统监控：Prometheus采集关键指标(响应时间/错误率/资源使用率)
     - 日志管理：ELK栈集中式日志收集与分析
     - 链路追踪：SkyWalking实现分布式调用链可视化
   - 测试策略：
     - 单元测试：核心业务逻辑覆盖率≥80%
     - 集成测试：API接口自动化测试
     - 性能测试：大模型并发调用压力测试
   - 核心业务流程：
     1. 用户上传多类型素材
     2. 大模型生成图文内容
     3. 人工校准修改后保存
     4. 选择渠道自动发布
     5. 操作记录持久化
   - 首期实现重点：
     - 前端不实现权限管理和登录功能
     - 优先完成主流程功能
